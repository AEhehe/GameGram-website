<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <title>Talha - 2048 Game</title>
  <link rel="icon" href="https://i.ibb.co/M6KTWnf/pic.jpg" />
  <style>
    body {
      background-color: #faf8ef;
      display: flex;
      justify-content: center;
      font-family: "Clear Sans", "Helvetica Neue";
    }
    h1 {
      font-size: 80px;
      line-height: 0.7;
      color: #776e65;
      margin: 0px;
    }
    .container {
      width: 468px;
      margin-top: 10px;
    }
    .info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .grid {
      display: flex;
      flex-wrap: wrap;
      width: 456px;
      height: 456px;
      background-color: #bbada0;
      border: 7px solid #bbada0;
      border-radius: 6px;
      margin-top: 20px;
    }
    .grid div {
      width: 100px;
      height: 100px;
      margin: 7px;
      border-radius: 3px;
      background-color: #eee4da;
      color: #afa192;
      font-weight: bold;
      text-align: center;
      font-size: 60px;
      line-height: 1.6;
    }
    .score-container {
      text-align: center;
      width: 70px;
      height: 60px;
      border-radius: 3px;
      background-color: #8f7a66;
      color: #ffffff;
    }
    #score {
      font-size: 30px;
    }
    .score-title {
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="info">
      <h1>2048</h1>
      <div class="score-container">
        <div class="score-title">score</div>
        <span id="score">0</span>
      </div>
    </div>
    <span id="result">Join the numbers and get to the <b>2048</b> tile!</span>
    <div class="grid"></div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const gridDisplay = document.querySelector(".grid");
      const scoreDisplay = document.getElementById("score");
      const resultDisplay = document.getElementById("result");
      let squares = [];
      const width = 4;
      let score = 0;

      function createBoard() {
        for (let i = 0; i < width * width; i++) {
          const square = document.createElement("div");
          square.innerHTML = 0;
          gridDisplay.appendChild(square);
          squares.push(square);
        }
        generate();
        generate();
      }
      createBoard();

      function generate() {
        const randomNumber = Math.floor(Math.random() * squares.length);
        if (squares[randomNumber].innerHTML == 0) {
          squares[randomNumber].innerHTML = 2;
          checkForGameOver();
        } else generate();
      }

      function moveRight() {
        for (let i = 0; i < 16; i++) {
          if (i % 4 === 0) {
            let row = [
              parseInt(squares[i].innerHTML),
              parseInt(squares[i + 1].innerHTML),
              parseInt(squares[i + 2].innerHTML),
              parseInt(squares[i + 3].innerHTML),
            ];
            let filteredRow = row.filter((num) => num);
            let zeros = Array(4 - filteredRow.length).fill(0);
            let newRow = zeros.concat(filteredRow);
            squares[i].innerHTML = newRow[0];
            squares[i + 1].innerHTML = newRow[1];
            squares[i + 2].innerHTML = newRow[2];
            squares[i + 3].innerHTML = newRow[3];
          }
        }
      }

      function moveLeft() {
        for (let i = 0; i < 16; i++) {
          if (i % 4 === 0) {
            let row = [
              parseInt(squares[i].innerHTML),
              parseInt(squares[i + 1].innerHTML),
              parseInt(squares[i + 2].innerHTML),
              parseInt(squares[i + 3].innerHTML),
            ];
            let filteredRow = row.filter((num) => num);
            let zeros = Array(4 - filteredRow.length).fill(0);
            let newRow = filteredRow.concat(zeros);
            squares[i].innerHTML = newRow[0];
            squares[i + 1].innerHTML = newRow[1];
            squares[i + 2].innerHTML = newRow[2];
            squares[i + 3].innerHTML = newRow[3];
          }
        }
      }

      function moveUp() {
        for (let i = 0; i < 4; i++) {
          let column = [
            parseInt(squares[i].innerHTML),
            parseInt(squares[i + width].innerHTML),
            parseInt(squares[i + width * 2].innerHTML),
            parseInt(squares[i + width * 3].innerHTML),
          ];
          let filteredColumn = column.filter((num) => num);
          let zeros = Array(4 - filteredColumn.length).fill(0);
          let newColumn = filteredColumn.concat(zeros);
          squares[i].innerHTML = newColumn[0];
          squares[i + width].innerHTML = newColumn[1];
          squares[i + width * 2].innerHTML = newColumn[2];
          squares[i + width * 3].innerHTML = newColumn[3];
        }
      }

      function moveDown() {
        for (let i = 0; i < 4; i++) {
          let column = [
            parseInt(squares[i].innerHTML),
            parseInt(squares[i + width].innerHTML),
            parseInt(squares[i + width * 2].innerHTML),
            parseInt(squares[i + width * 3].innerHTML),
          ];
          let filteredColumn = column.filter((num) => num);
          let zeros = Array(4 - filteredColumn.length).fill(0);
          let newColumn = zeros.concat(filteredColumn);
          squares[i].innerHTML = newColumn[0];
          squares[i + width].innerHTML = newColumn[1];
          squares[i + width * 2].innerHTML = newColumn[2];
          squares[i + width * 3].innerHTML = newColumn[3];
        }
      }

      function combineRow() {
        for (let i = 0; i < 15; i++) {
          if (squares[i].innerHTML === squares[i + 1].innerHTML) {
            let combined = parseInt(squares[i].innerHTML) + parseInt(squares[i + 1].innerHTML);
            squares[i].innerHTML = combined;
            squares[i + 1].innerHTML = 0;
            score += combined;
            scoreDisplay.innerHTML = score;
          }
        }
        checkForWin();
      }

      function combineColumn() {
        for (let i = 0; i < 12; i++) {
          if (squares[i].innerHTML === squares[i + width].innerHTML) {
            let combined = parseInt(squares[i].innerHTML) + parseInt(squares[i + width].innerHTML);
            squares[i].innerHTML = combined;
            squares[i + width].innerHTML = 0;
            score += combined;
            scoreDisplay.innerHTML = score;
          }
        }
        checkForWin();
      }

      function control(e) {
        if (e.keyCode === 37) keyLeft();
        else if (e.keyCode === 38) keyUp();
        else if (e.keyCode === 39) keyRight();
        else if (e.keyCode === 40) keyDown();
      }
      document.addEventListener("keyup", control);

      function keyRight() {
        moveRight();
        combineRow();
        moveRight();
        generate();
      }
      function keyLeft() {
        moveLeft();
        combineRow();
        moveLeft();
        generate();
      }
      function keyUp() {
        moveUp();
        combineColumn();
        moveUp();
        generate();
      }
      function keyDown() {
        moveDown();
        combineColumn();
        moveDown();
        generate();
      }

      function checkForWin() {
        for (let i = 0; i < squares.length; i++) {
          if (squares[i].innerHTML == 2048) {
            resultDisplay.innerHTML = "You WIN";
            document.removeEventListener("keyup", control);
            setTimeout(() => clear(), 3000);
          }
        }
      }

      function checkForGameOver() {
        let zeros = 0;
        for (let i = 0; i < squares.length; i++) {
          if (squares[i].innerHTML == 0) zeros++;
        }
        if (zeros === 0) {
          resultDisplay.innerHTML = "You LOSE";
          document.removeEventListener("keyup", control);
          setTimeout(() => clear(), 3000);
        }
      }

      function clear() {
        clearInterval(myTimer);
      }

      function addColours() {
        for (let i = 0; i < squares.length; i++) {
          let value = squares[i].innerHTML;
          let colors = {
            0: "#afa192",
            2: "#eee4da",
            4: "#ede0c8",
            8: "#f2b179",
            16: "#ffcea4",
            32: "#e8c064",
            64: "#ffab6e",
            128: "#fd9982",
            256: "#ead79c",
            512: "#76daff",
            1024: "#beeaa5",
            2048: "#d7d4f0"
          };
          squares[i].style.backgroundColor = colors[value] || "#afa192";
        }
      }
      addColours();
      var myTimer = setInterval(addColours, 50);
    });
  </script>
</body>
</html>
